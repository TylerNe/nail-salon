<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precison Nail</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="keypad.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.5.2/css/tabulator.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-left">
                <h1><img src="assets/icon.png" alt="Logo" class="header-logo"> Precison Nail</h1>
            </div>
            <div class="header-right">
                <div class="network-info" id="networkInfo">
                    <span class="network-label">üåê Network:</span>
                    <span class="network-url" id="networkUrl">Loading...</span>
                </div>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="tab-navigation">
            <button class="tab-btn active" data-tab="dashboard">
                <i class="fas fa-table"></i> Dashboard
            </button>
            <button class="tab-btn" data-tab="statistics">
                <i class="fas fa-chart-bar"></i> Th·ªëng k√™
            </button>
            <button class="tab-btn" data-tab="expenses">
                <i class="fas fa-receipt"></i> Chi ti√™u
            </button>
            <button class="tab-btn" data-tab="staff">
                <i class="fas fa-users"></i> Qu·∫£n l√Ω Staff
            </button>
            <button class="tab-btn" data-tab="work-schedule">
                <i class="fas fa-calendar-alt"></i> L·ªãch l√†m vi·ªác
            </button>
            <button class="tab-btn" data-tab="transactions">
                <i class="fas fa-history"></i> L·ªãch s·ª≠ giao d·ªãch
            </button>
            <button class="tab-btn" data-tab="gift-cards">
                <i class="fas fa-gift"></i> Gift Cards
            </button>
            <button class="tab-btn" data-tab="payroll" title="Y√™u c·∫ßu m·∫≠t kh·∫©u">
                <i class="fas fa-lock"></i> Payroll & Shifts
            </button>
        </nav>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <!-- Controls -->
            <div class="controls-section">
                <div class="control-group">
                    <label for="dateFilter">Ch·ªçn ng√†y:</label>
                    <input type="date" id="dateFilter" class="form-control">
                    <button id="refreshBtn" class="btn btn-secondary">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                
                <div class="control-group">
                    <label for="staffSearch">T√¨m ki·∫øm staff:</label>
                    <input type="text" id="staffSearch" placeholder="Nh·∫≠p t√™n staff..." class="form-control">
                </div>
            </div>


            <!-- Main Table -->
            <div class="table-section">
                <h3><i class="fas fa-table"></i> B·∫£ng Doanh Thu</h3>
                <div id="revenueTable"></div>
            </div>

            <!-- Entries Detail Table -->
            <div class="table-section">
                <h3><i class="fas fa-list"></i> Chi Ti·∫øt Entries</h3>
                <div id="entriesDetailTable"></div>
            </div>
        </div>

        <!-- Statistics Tab -->
        <div id="statistics" class="tab-content">
            <div class="stats-controls">
                <div class="control-group">
                    <label for="statsPeriod">Chu k·ª≥:</label>
                    <select id="statsPeriod" class="form-control">
                        <option value="daily">Theo ng√†y</option>
                        <option value="weekly">Theo tu·∫ßn</option>
                        <option value="monthly" selected>Theo th√°ng</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="statsStartDate">T·ª´ ng√†y:</label>
                    <input type="date" id="statsStartDate" class="form-control">
                </div>
                
                <div class="control-group">
                    <label for="statsEndDate">ƒê·∫øn ng√†y:</label>
                    <input type="date" id="statsEndDate" class="form-control">
                </div>
                
                <button id="loadStatsBtn" class="btn btn-primary">
                    <i class="fas fa-chart-bar"></i> T·∫£i th·ªëng k√™
                </button>
            </div>
            
            <div class="stats-content">
                <div class="stats-chart">
                    <canvas id="statsChart"></canvas>
                </div>
                
                <div class="stats-table">
                    <div id="statsTable"></div>
                </div>
            </div>
        </div>

        <!-- Daily Expenses Tab -->
        <div id="expenses" class="tab-content">
            <div class="expenses-header">
                <h2><i class="fas fa-receipt"></i> Chi Ti√™u H√†ng Ng√†y</h2>
                <div class="expenses-controls">
                    <div class="control-group">
                        <label for="expenseDateFilter">Ch·ªçn ng√†y:</label>
                        <input type="date" id="expenseDateFilter" class="form-control">
                    </div>
                    <button id="addExpenseBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Th√™m Chi Ti√™u
                    </button>
                </div>
            </div>
            
            <div class="expenses-summary">
                <div class="summary-card">
                    <div class="card-icon" style="background: #dc3545;">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <div class="card-content">
                        <div class="card-label">T·ªïng Chi Ti√™u H√¥m Nay</div>
                        <div class="card-value" id="todayExpensesTotal">$0.00</div>
                    </div>
                </div>
            </div>
            
            <div class="expenses-table-container">
                <div class="table-header">
                    <h3>Danh S√°ch Chi Ti√™u</h3>
                    <div class="table-controls">
                        <input type="text" id="expenseSearch" placeholder="T√¨m ki·∫øm..." class="form-control">
                        <select id="expenseCategoryFilter" class="form-control">
                            <option value="">T·∫•t c·∫£ lo·∫°i</option>
                            <option value="materials">V·∫≠t li·ªáu</option>
                            <option value="utilities">ƒêi·ªán n∆∞·ªõc</option>
                            <option value="rent">Thu√™ m·∫∑t b·∫±ng</option>
                            <option value="other">Kh√°c</option>
                        </select>
                    </div>
                </div>
                <div id="expensesTable"></div>
            </div>
        </div>

        <!-- Staff Management Tab -->
        <div id="staff" class="tab-content">
            <div class="staff-controls">
                <h3><i class="fas fa-users"></i> Qu·∫£n l√Ω Staff</h3>
                <form id="addStaffForm" class="staff-form">
                    <div class="form-row">
                        <input type="text" id="staffName" placeholder="T√™n staff m·ªõi..." class="form-control" required>
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-plus"></i> Th√™m Staff
                        </button>
                    </div>
                </form>
            </div>
            
            <div class="staff-list">
                <div id="staffTable"></div>
            </div>

            <div class="staff-leaderboard">
                <h4><i class="fas fa-trophy"></i> B·∫£ng x·∫øp h·∫°ng Staff</h4>
                <div class="staff-leaderboard-range">
                    <span>Kho·∫£ng ng√†y:</span>
                    <input type="date" id="staffLeaderboardStart" class="form-control staff-leaderboard-date">
                    <span>ƒë·∫øn</span>
                    <input type="date" id="staffLeaderboardEnd" class="form-control staff-leaderboard-date">
                    <button id="staffLeaderboardApply" class="btn btn-primary btn-sm">L·ªçc</button>
                    <span id="staffLeaderboardRangeText" class="staff-leaderboard-range-text"></span>
                </div>
                <div class="staff-leaderboard-table-wrapper">
                    <table class="staff-leaderboard-table">
                        <thead>
                            <tr>
                                <th>H·∫°ng</th>
                                <th>Staff</th>
                                <th>S·ªë kh√°ch</th>
                                <th>Doanh thu (AUD)</th>
                                <th>Avg / Customer</th>
                            </tr>
                        </thead>
                        <tbody id="staffLeaderboardBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Edit Staff Name Modal -->
        <div id="editStaffModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-edit"></i> ƒê·ªïi t√™n Staff</h3>
                    <span class="modal-close" onclick="closeEditStaffModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <form id="editStaffForm">
                        <input type="hidden" id="editStaffId">
                        <div class="form-group">
                            <label for="editStaffName">T√™n Staff:</label>
                            <input type="text" id="editStaffName" class="form-control" required autofocus>
                        </div>
                        <div class="modal-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeEditStaffModal()">H·ªßy</button>
                            <button type="submit" class="btn btn-primary">L∆∞u</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Work Schedule Tab -->
        <div id="work-schedule" class="tab-content">
            <div class="work-schedule-controls">
                <h3><i class="fas fa-calendar-alt"></i> Qu·∫£n l√Ω L·ªãch L√†m Vi·ªác</h3>
                <div class="control-group">
                    <label for="scheduleDateFilter">Ch·ªçn ng√†y:</label>
                    <input type="date" id="scheduleDateFilter" class="form-control">
                </div>
            </div>
            
            <div class="work-schedule-section">
                <h4><i class="fas fa-users"></i> Danh S√°ch Nh√¢n Vi√™n</h4>
                <div id="workScheduleListContainer" class="work-schedule-list-container"></div>
            </div>
            
            <div class="work-schedule-summary">
                <h4><i class="fas fa-info-circle"></i> Th√¥ng Tin</h4>
                <p>Ch·ªâ nh·ªØng nh√¢n vi√™n ƒë∆∞·ª£c ƒë√°nh d·∫•u c√≥ ng√†y l√†m vi·ªác m·ªõi xu·∫•t hi·ªán trong b·∫£ng doanh thu.</p>
                <p>Nh√¢n vi√™n kh√¥ng c√≥ ng√†y l√†m vi·ªác s·∫Ω kh√¥ng th·ªÉ nh·∫≠p doanh thu.</p>
                <p><strong>Li√™n k·∫øt v·ªõi Payroll:</strong> Khi th√™m/x√≥a ng√†y l√†m vi·ªác, h·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông t·∫°o/x√≥a ca l√†m vi·ªác trong Payroll & Shifts.</p>
            </div>
        </div>

        <!-- Transactions Tab -->
        <div id="transactions" class="tab-content">
            <div class="section-header">
                <h2><i class="fas fa-history"></i> L·ªãch s·ª≠ giao d·ªãch</h2>
                <div class="controls">
                    <input type="date" id="transactionsStartDate" placeholder="T·ª´ ng√†y" class="form-control">
                    <input type="date" id="transactionsEndDate" placeholder="ƒê·∫øn ng√†y" class="form-control">
                    <select id="transactionsStaffFilter" class="form-control">
                        <option value="">T·∫•t c·∫£ nh√¢n vi√™n</option>
                    </select>
                    <select id="transactionsPaymentFilter" class="form-control">
                        <option value="">T·∫•t c·∫£ ph∆∞∆°ng th·ª©c</option>
                        <option value="cash">Ti·ªÅn m·∫∑t</option>
                        <option value="card">Th·∫ª</option>
                        <option value="gift_card">Gift Card</option>
                    </select>
                    <button id="loadTransactionsBtn" class="btn btn-primary">
                        <i class="fas fa-search"></i> T√¨m ki·∫øm
                    </button>
                    <button id="exportTransactionsBtn" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Xu·∫•t Excel
                    </button>
                </div>
            </div>
            
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>T·ªïng ti·ªÅn m·∫∑t</h3>
                    <span id="totalCash">$0.00</span>
                </div>
                <div class="summary-card">
                    <h3>T·ªïng th·∫ª</h3>
                    <span id="totalCard">$0.00</span>
                </div>
                <div class="summary-card">
                    <h3>T·ªïng Gift Card</h3>
                    <span id="totalGiftCard">$0.00</span>
                </div>
                <div class="summary-card">
                    <h3>T·ªïng giao d·ªãch</h3>
                    <span id="totalTransactions">0</span>
                </div>
            </div>
            
            <div id="transactionsTable"></div>
        </div>

        <!-- Gift Cards Tab -->
        <div id="gift-cards" class="tab-content">
            <div class="section-header">
                <h2><i class="fas fa-gift"></i> Qu·∫£n l√Ω Gift Cards</h2>
                <div class="controls">
                    <button id="createGiftCardBtn" class="btn btn-primary" onclick="openCreateGiftCardDialog()">
                        <i class="fas fa-plus"></i> T·∫°o Gift Card
                    </button>
                    <input type="text" id="giftCardSearch" placeholder="T√¨m ki·∫øm theo s·ªë th·∫ª, t√™n, SƒêT..." class="form-control">
                    <select id="giftCardStatusFilter" class="form-control">
                        <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                        <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
                        <option value="used">ƒê√£ s·ª≠ d·ª•ng</option>
                        <option value="expired">H·∫øt h·∫°n</option>
                        <option value="cancelled">ƒê√£ h·ªßy</option>
                    </select>
                </div>
            </div>
            
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>T·ªïng Gift Cards</h3>
                    <span id="totalGiftCards">0</span>
                </div>
                <div class="summary-card">
                    <h3>T·ªïng gi√° tr·ªã</h3>
                    <span id="totalGiftCardValue">$0.00</span>
                </div>
                <div class="summary-card">
                    <h3>S·ªë d∆∞ c√≤n l·∫°i</h3>
                    <span id="totalGiftCardBalance">$0.00</span>
                </div>
                <div class="summary-card">
                    <h3>ƒê√£ s·ª≠ d·ª•ng</h3>
                    <span id="totalGiftCardUsed">$0.00</span>
                </div>
            </div>
            
            <div id="giftCardsTable"></div>
        </div>

        <!-- Payroll & Shifts Tab (Protected) -->
        <div id="payroll" class="tab-content">
            <!-- Password Unlock Screen -->
            <div id="payrollLockScreen" class="lock-screen">
                <div class="lock-container">
                    <div class="lock-icon">
                        <i class="fas fa-lock"></i>
                    </div>
                    <h2>Khu V·ª±c B·∫£o M·∫≠t</h2>
                    <p>Nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p Payroll & Shifts</p>
                    <form id="unlockPayrollForm">
                        <input type="password" id="payrollPassword" class="form-control password-input" 
                               placeholder="Nh·∫≠p m·∫≠t kh·∫©u..." required>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-unlock"></i> M·ªü Kh√≥a
                        </button>
                    </form>
                    
                </div>
            </div>

            <!-- Payroll Content (Hidden until unlocked) -->
            <div id="payrollContent" class="payroll-content" style="display: none;">
                <!-- Lock button -->
                <div class="payroll-header">
                    <button id="lockPayrollBtn" class="btn btn-danger">
                        <i class="fas fa-lock"></i> Kh√≥a L·∫°i
                    </button>
                    <button id="changePasswordBtn" class="btn btn-secondary">
                        <i class="fas fa-key"></i> ƒê·ªïi M·∫≠t Kh·∫©u
                    </button>
                </div>

                <!-- Sub-tabs for Payroll features -->
                <nav class="payroll-sub-tabs">
                    <button class="payroll-tab-btn active" data-payroll-tab="shifts">
                        <i class="fas fa-calendar-check"></i> Shifts
                    </button>
                    <button class="payroll-tab-btn" data-payroll-tab="rates">
                        <i class="fas fa-dollar-sign"></i> Rates
                    </button>
                    <button class="payroll-tab-btn" data-payroll-tab="income">
                        <i class="fas fa-chart-line"></i> Income Reports
                    </button>
                    <button class="payroll-tab-btn" data-payroll-tab="settings-payroll">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                </nav>

                <!-- Shifts Sub-tab -->
                <div id="shifts" class="payroll-tab-content active">
                    <div class="controls-section">
                        <div class="control-group">
                            <label for="shiftsDateFilter">Ch·ªçn ng√†y:</label>
                            <input type="date" id="shiftsDateFilter" class="form-control">
                        </div>
                    </div>
                    <div class="shifts-section">
                        <h3><i class="fas fa-users"></i> Danh S√°ch Ca L√†m Vi·ªác</h3>
                        <div id="shiftsListContainer" class="shifts-list-container"></div>
                    </div>
                </div>

                <!-- Rates Sub-tab -->
                <div id="rates" class="payroll-tab-content">
                    <div class="rates-section">
                        <h3><i class="fas fa-money-bill-wave"></i> L∆∞∆°ng M·∫∑c ƒê·ªãnh Theo Staff</h3>
                        <div class="rates-table-container">
                            <table class="rates-table" id="ratesTable">
                                <thead>
                                    <tr>
                                        <th>Staff</th>
                                        <th>L∆∞∆°ng m·∫∑c ƒë·ªãnh (AUD)</th>
                                    </tr>
                                </thead>
                                <tbody id="ratesTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Income Reports Sub-tab -->
                <div id="income" class="payroll-tab-content">
                    <div class="controls-section">
                        <div class="control-group">
                            <label for="incomeStartDate">T·ª´ ng√†y:</label>
                            <input type="date" id="incomeStartDate" class="form-control">
                        </div>
                        <div class="control-group">
                            <label for="incomeEndDate">ƒê·∫øn ng√†y:</label>
                            <input type="date" id="incomeEndDate" class="form-control">
                        </div>
                        <button id="loadIncomeBtn" class="btn btn-primary">
                            <i class="fas fa-sync-alt"></i> T·∫£i B√°o C√°o
                        </button>
                        <button id="exportIncomeBtn" class="btn btn-success">
                            <i class="fas fa-download"></i> Export CSV
                        </button>
                    </div>

                    <!-- Summary Cards -->
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="card-icon" style="background: #28a745;">
                                <i class="fas fa-dollar-sign"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">Total Gross</div>
                                <div class="card-value" id="totalGross">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #ffc107;">
                                <i class="fas fa-wallet"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">Total Wages</div>
                                <div class="card-value" id="totalWages">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #17a2b8;">
                                <i class="fas fa-home"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">Total Rent</div>
                                <div class="card-value" id="totalRent">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #6f42c1;">
                                <i class="fas fa-file-invoice-dollar"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">GST (10%)</div>
                                <div class="card-value" id="totalGST">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #dc3545;">
                                <i class="fas fa-receipt"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">Daily Expenses</div>
                                <div class="card-value" id="totalExpenses">$0.00</div>
                            </div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #007bff;">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="card-content">
                                <div class="card-label">Net Profit</div>
                                <div class="card-value" id="totalNet">$0.00</div>
                            </div>
                        </div>
                    </div>

                    <div class="income-section">
                        <h3><i class="fas fa-table"></i> Chi Ti·∫øt B√°o C√°o</h3>
                        <div class="income-table-container">
                            <table class="income-table" id="incomeTable">
                                <thead>
                                    <tr>
                                        <th>Ng√†y</th>
                                        <th>Gross (Doanh thu)</th>
                                        <th>Wages (L∆∞∆°ng)</th>
                                        <th>Rent (Thu√™)</th>
                                        <th>Expenses (Chi ti√™u)</th>
                                        <th>Net (L·ª£i nhu·∫≠n)</th>
                                    </tr>
                                </thead>
                                <tbody id="incomeTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Settings Sub-tab -->
                <div id="settings-payroll" class="payroll-tab-content">
                    <div class="settings-section">
                        <h3><i class="fas fa-cog"></i> C√†i ƒê·∫∑t Ti·ªÅn Thu√™</h3>
                        <form id="rentSettingsForm" class="settings-form">
                            <div class="form-group">
                                <label for="rentAmount">Ti·ªÅn thu√™ (AUD):</label>
                                <input type="text" id="rentAmount" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="rentPeriod">Chu k·ª≥:</label>
                                <select id="rentPeriod" class="form-control">
                                    <option value="daily">H√†ng ng√†y</option>
                                </select>
                            </div>
                            <button type="submit" class="btn btn-success">
                                <i class="fas fa-save"></i> L∆∞u C√†i ƒê·∫∑t
                            </button>
                        </form>
                    </div>

                    <div class="settings-section">
                        <h3><i class="fas fa-key"></i> ƒê·ªïi M·∫≠t Kh·∫©u</h3>
                        <form id="changePasswordForm" class="settings-form">
                            <div class="form-group">
                                <label for="oldPassword">M·∫≠t kh·∫©u c≈©:</label>
                                <input type="password" id="oldPassword" class="form-control" required placeholder="Nh·∫≠p m·∫≠t kh·∫©u c≈©...">
                            </div>
                            <div class="form-group">
                                <label for="newPassword">M·∫≠t kh·∫©u m·ªõi:</label>
                                <input type="password" id="newPassword" class="form-control" required placeholder="Nh·∫≠p m·∫≠t kh·∫©u m·ªõi...">
                            </div>
                            <div class="form-group">
                                <label for="confirmPassword">X√°c nh·∫≠n m·∫≠t kh·∫©u:</label>
                                <input type="password" id="confirmPassword" class="form-control" required placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u m·ªõi...">
                            </div>
                            <button type="submit" class="btn btn-warning">
                                <i class="fas fa-key"></i> ƒê·ªïi M·∫≠t Kh·∫©u
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>ƒêang t·∫£i...</p>
        </div>
    </div>

    <!-- PIN Modal for Expenses -->
    <div id="expensesPinModal" class="modal">
        <div class="modal-content pin-modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-lock"></i> X√°c th·ª±c m√£ PIN</h3>
            </div>
            <div class="pin-display">
                <div class="pin-dots">
                    <div class="pin-dot" id="pinDot1"></div>
                    <div class="pin-dot" id="pinDot2"></div>
                    <div class="pin-dot" id="pinDot3"></div>
                    <div class="pin-dot" id="pinDot4"></div>
                    <div class="pin-dot" id="pinDot5"></div>
                    <div class="pin-dot" id="pinDot6"></div>
                </div>
                <div id="expensesPinError" class="error-message" style="display: none;"></div>
            </div>
            <div class="pin-keypad">
                <div class="keypad-row">
                    <button class="pin-key" data-number="1">1</button>
                    <button class="pin-key" data-number="2">2</button>
                    <button class="pin-key" data-number="3">3</button>
                </div>
                <div class="keypad-row">
                    <button class="pin-key" data-number="4">4</button>
                    <button class="pin-key" data-number="5">5</button>
                    <button class="pin-key" data-number="6">6</button>
                </div>
                <div class="keypad-row">
                    <button class="pin-key" data-number="7">7</button>
                    <button class="pin-key" data-number="8">8</button>
                    <button class="pin-key" data-number="9">9</button>
                </div>
                <div class="keypad-row">
                    <button class="pin-key pin-key-empty"></button>
                    <button class="pin-key" data-number="0">0</button>
                    <button class="pin-key pin-key-backspace" id="pinBackspace">
                        <i class="fas fa-backspace"></i>
                    </button>
                </div>
            </div>
            <div class="pin-actions">
                <button type="button" id="expensesPinCancel" class="btn btn-secondary">H·ªßy</button>
            </div>
        </div>
    </div>

    <!-- Expense Modal -->
    <div id="expenseModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="expenseModalTitle">Th√™m Chi Ti√™u</h3>
                <span class="close" id="closeExpenseModal">&times;</span>
            </div>
            <form id="expenseForm">
                <div class="form-group">
                    <label for="expenseDate">Ng√†y:</label>
                    <input type="date" id="expenseDate" class="form-control" required>
                </div>
                
                <div class="form-group">
                    <label for="expenseCategory">Lo·∫°i chi ti√™u:</label>
                    <select id="expenseCategory" class="form-control" required>
                        <option value="">Ch·ªçn lo·∫°i chi ti√™u</option>
                        <option value="materials">V·∫≠t li·ªáu</option>
                        <option value="utilities">ƒêi·ªán n∆∞·ªõc</option>
                        <option value="rent">Thu√™ m·∫∑t b·∫±ng</option>
                        <option value="other">Kh√°c</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="expenseDescription">M√¥ t·∫£:</label>
                    <input type="text" id="expenseDescription" class="form-control" placeholder="VD: Mua s∆°n m√≥ng tay" required>
                </div>
                
                <div class="form-group">
                    <label for="expenseAmount">S·ªë ti·ªÅn (AUD):</label>
                    <input type="number" id="expenseAmount" class="form-control" step="0.01" min="0.01" placeholder="0.00" required>
                </div>
                
                <div class="form-group">
                    <label for="expenseNotes">Ghi ch√∫ (t√πy ch·ªçn):</label>
                    <textarea id="expenseNotes" class="form-control" rows="3" placeholder="Ghi ch√∫ th√™m..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" id="cancelExpenseBtn">H·ªßy</button>
                    <button type="submit" class="btn btn-primary" id="saveExpenseBtn">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Alert Container -->
    <div id="alertContainer" class="alert-container"></div>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/5.5.2/js/tabulator.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Check if Chart.js loaded
        if (typeof Chart === 'undefined') {
            console.error('Chart.js failed to load from CDN');
            // Try fallback CDN
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js';
            script.onload = function() {
                console.log('Chart.js loaded from fallback CDN');
            };
            script.onerror = function() {
                console.error('Chart.js failed to load from both CDNs');
                alert('Chart.js kh√¥ng th·ªÉ load t·ª´ CDN. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi internet.');
            };
            document.head.appendChild(script);
        } else {
            console.log('Chart.js loaded successfully from official CDN');
        }
    </script>
    <script src="keypad.js"></script>
    <script src="web-api.js"></script>
    <script src="expenses-simple.js"></script>

    <!-- Core app logic -->
    <script src="renderer.js"></script>

    <!-- Feature modules -->
    <script src="work-schedule.js"></script>
    <script src="payroll.js"></script>
    <script src="transactions.js"></script>
    <script src="gift-cards.js"></script>
    <script src="expenses-ui.js"></script>
</body>
</html>
